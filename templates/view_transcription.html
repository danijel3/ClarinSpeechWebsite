{% extends "layout.html" %}
{% block body %}
    <h1>{% trans %}view_trans_tytuł{% endtrans %}</h1>

    <a href="#" onclick="window.history.back()">{% trans %}powrót{% endtrans %}</a></p>

    <div class="card form-group card-block">
        <textarea id="result" class="form-control" style="height: 20em;" readonly="true"></textarea>
        <div id="progress-msg" class="alert alert-info fade show" role="alert">
            <span class="fa fa-refresh fa-spin"></span>
            {% trans %}pracuję{% endtrans %}
        </div>
    </div>

    <div id="error-msg" class="alert fade" role="alert">
    </div>

    <div class="card form-group card-block">
        <p>{% trans %}ident_res{% endtrans %}</p>

        <p><a href="/tools/ui/view/{{ res_id }}">{{ res_id }}</a></p>

        <p>{% trans %}ident_from{% endtrans %}</p>
        {% if from_id %}
            <p><a href="/tools/ui/view/{{ from_id }}" target="_blank">{{ from_id }}</a></p>
        {% else %}
            <p>{% trans %}nieznany_f5{% endtrans %}</p>
        {% endif %}

        {% if from_audio %}
            <p><a href="/tools/ui/multiview/{{ from_id }}/{{ res_id }}" class="btn btn-info">
                {% trans %}otwórz_z_audio{% endtrans %}
            </a></p>
        {% endif %}
    </div>

    <div class="card form-control card-block" style="margin-top: 15px">

        <h3 class="card-title">{% trans %}cytowanie{% endtrans %}</h3>

        <p>{% trans %}cytowanie_opis{% endtrans %}</p>

        <p style="padding: 15px; background-color: #eee">
            <b>Danijel Koržinek, Krzysztof Marasek, Łukasz Brocki and Krzysztof Wołk</b>: <i>Polish Read Speech
            Corpus for Speech Tools and Services</i>, Selected papers from the CLARIN Annual Conference 2016,
            Aix-en-Provence, 26–28 October 2016, CLARIN Common Language Resourcesand Technology Infrastructure, number
            136, pages 54–62. LinköpingUniversity Electronic Press, Linköpings universitet, 2017.
        </p>
        <p><a href="http://www.ep.liu.se/ecp/136/004/ecp17136004.pdf">{% trans %}link_do_pracy{% endtrans %}</a></p>
    </div>

    <script type="text/javascript">

        $.ajaxSetup({cache: false});

        var fail_count = 10;
        var time_delay = 100;

        function display() {
            $.get('/tools/download/' + encodeURI('{{ res_id }}'))
                .done(function (data) {
                    $('#result').val(data);
                    $("#progress-msg").alert('close');
                }).fail(function (data) {
                if (data['status'] == 503) {
                    if (fail_count > 0) {
                        setTimeout(display, time_delay);
                        time_delay += 100;
                        fail_count--;
                    } else {
                        $('#progress-msg').alert('close');
                        $('#error-msg').addClass('show');
                        $('#error-msg').addClass('alert-warning');
                        $('#error-msg').html('{% trans %}f5_refresh{% endtrans %}');
                    }
                } else {
                    $('#progress-msg').alert('close');
                    $('#error-msg').addClass('show');
                    $('#error-msg').addClass('alert-danger');
                    $('#error-msg').html('{% trans %}błąd_admin{% endtrans %}');
                }
            });
        }

        display();
    </script>

{% endblock %}